<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.91.2" />
    <meta name="description" content="Documentation for Hugo Learn Theme">
<meta name="author" content="Mathieu Cornic">

    <title>Introduction :: Environmental Computing</title>

    
    <link href="/css/nucleus.css?1643067537" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1643067537" rel="stylesheet">
    <link href="/css/hybrid.css?1643067537" rel="stylesheet">
    <link href="/css/featherlight.min.css?1643067537" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1643067537" rel="stylesheet">
    <link href="/css/auto-complete.css?1643067537" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1643067537" rel="stylesheet">
    <link href="/css/theme.css?1643067537" rel="stylesheet">
    <link href="/css/tabs.css?1643067537" rel="stylesheet">
    <link href="/css/hugo-theme.css?1643067537" rel="stylesheet">
    
    <link href="/css/theme-green.css?1643067537" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1643067537"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/statistics/mixed-models/mixed-model-1/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/'>

<svg id="grav-logo" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	width="100%" height="100%"  viewBox="0 0 285.1 69.9" xml:space="preserve">
<g>
	<path d="M35,0c9.6,0,17.9,3.4,24.7,10.3c6.8,6.8,10.3,15,10.3,24.7c0,9.7-3.4,17.9-10.3,24.7c-6.8,6.8-15,10.3-24.7,10.3
		c-9.7,0-17.9-3.4-24.7-10.3C3.4,52.8,0,44.6,0,34.9c0-9.6,3.4-17.9,10.3-24.7C17.1,3.4,25.3,0,35,0z M22.3,63.7
		c0.3-7.4,0.3-14.7,0-22.1c-2.1-0.4-4-0.4-5.9,0c-0.2,0.8-0.2,2.5-0.1,4.9c0.1,2.3,0,3.9-0.3,4.8c-1.7-0.6-2.7-2.1-3.1-4.6
		c-0.1-0.7-0.1-3.3-0.1-8c0-14.5-0.1-23-0.3-25.6c-3.6,4.1-5.6,7-5.9,8.5v10.9c0,4.5,0.1,8.1,0.2,10.9c0,0.4,0,1.3-0.1,2.8
		c-0.1,1.2,0,2.1,0.1,2.6c0.1,0.6,1.1,2.1,2.8,4.7C13.2,58.7,17.5,62.2,22.3,63.7z M44.6,65.4c0.3-5,0.2-12.9-0.1-23.6
		c-2.1-0.3-4.1-0.3-5.9,0c-0.2,2-0.2,5.1-0.1,9.5c0.1,4.3,0,7.5-0.1,9.5c-2.9,0.4-5,0.3-6.2-0.1c-0.2-5.6-0.2-15.2-0.1-28.7
		c0.1-12.4,0-21.8-0.3-28.3c-2.4,0.1-4.3,0.6-5.7,1.3c-0.1,7.7-0.2,17.7-0.1,30.1c0,16.5,0,26.6,0,30.3c2.3,1.1,5.4,1.7,9.4,1.7
		C38.9,66.9,42.1,66.4,44.6,65.4z M48.1,64.1c9.7-4.6,15.7-12,18-22.2c-1.8-0.2-3.8-0.3-6.1-0.3c-1.6,3.9-2.6,6.3-3.2,7.2
		c-1.1,1.7-2,2.5-2.7,2.5C54,46,54,39.1,54,30.5c0-11.5,0-18.4,0-20.9c-1.4-1.4-3.3-2.5-5.7-3.4C48.1,6.3,48,6.4,48,6.7
		c0,3.5,0,13.1,0,28.8C47.9,47.2,48,56.8,48.1,64.1z"/>
</g>
<g>
	<path d="M116.6,51.3h-29c-0.5,0-0.9-0.1-1.3-0.2c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-1c-0.2-0.4-0.2-0.8-0.2-1.3V16.3h6.3
		V45h25.8V51.3z"/>
	<path d="M154.8,51.3h-22.9c-0.9,0-1.8-0.2-2.9-0.5c-1-0.3-2-0.8-2.9-1.5c-0.9-0.7-1.6-1.6-2.2-2.8c-0.6-1.1-0.9-2.5-0.9-4.2V19.5
		c0-0.4,0.1-0.9,0.2-1.2c0.2-0.4,0.4-0.7,0.7-1c0.3-0.3,0.6-0.5,1-0.7c0.4-0.2,0.8-0.2,1.3-0.2h28.6v6.3h-25.4v19.8
		c0,0.8,0.2,1.5,0.7,1.9s1.1,0.7,1.9,0.7h22.9V51.3z M151.9,37h-20v-6.4h20V37z"/>
	<path d="M197.3,51.3H191v-8.6h-22.3v8.6h-6.3V33.8c0-2.6,0.4-4.9,1.3-7.1s2.1-4,3.7-5.5c1.6-1.5,3.4-2.8,5.5-3.6
		c2.1-0.9,4.5-1.3,7-1.3h14.3c0.4,0,0.9,0.1,1.2,0.2c0.4,0.2,0.7,0.4,1,0.7s0.5,0.6,0.7,1c0.2,0.4,0.2,0.8,0.2,1.2V51.3z
		 M168.7,36.4H191V22.6h-11.2c-0.2,0-0.6,0-1.2,0.1c-0.6,0.1-1.4,0.2-2.2,0.4c-0.8,0.2-1.7,0.6-2.6,1c-0.9,0.5-1.8,1.1-2.5,2
		c-0.8,0.8-1.4,1.9-1.9,3.1c-0.5,1.2-0.7,2.8-0.7,4.5V36.4z"/>
	<path d="M241.7,28.1c0,1.4-0.2,2.7-0.5,3.9c-0.4,1.1-0.8,2.1-1.5,3c-0.6,0.9-1.3,1.6-2.1,2.2c-0.8,0.6-1.6,1.1-2.5,1.5
		c-0.9,0.4-1.8,0.7-2.6,0.9c-0.9,0.2-1.7,0.3-2.5,0.3l13.3,11.5h-9.8l-13.2-11.5h-4.6v-6.3H230c0.8-0.1,1.5-0.2,2.2-0.5
		c0.7-0.3,1.2-0.6,1.7-1.1c0.5-0.5,0.9-1,1.1-1.6c0.3-0.6,0.4-1.4,0.4-2.2v-4c0-0.4,0-0.6-0.1-0.8c-0.1-0.2-0.2-0.3-0.3-0.4
		c-0.1-0.1-0.3-0.1-0.4-0.2c-0.2,0-0.3,0-0.4,0h-20.9v28.7h-6.3V19.5c0-0.4,0.1-0.9,0.2-1.2c0.2-0.4,0.4-0.7,0.7-1
		c0.3-0.3,0.6-0.5,1-0.7c0.4-0.2,0.8-0.2,1.3-0.2H234c1.4,0,2.6,0.3,3.6,0.8s1.8,1.2,2.4,1.9c0.6,0.8,1,1.6,1.3,2.5
		c0.3,0.9,0.4,1.7,0.4,2.5V28.1z"/>
	<path d="M285.1,48.6c0,0.5-0.1,0.9-0.3,1.3c-0.2,0.4-0.4,0.7-0.7,1c-0.3,0.3-0.6,0.5-1,0.7c-0.4,0.2-0.8,0.2-1.2,0.2
		c-0.4,0-0.8-0.1-1.2-0.2c-0.4-0.1-0.8-0.4-1.1-0.7l-23.2-24.2v24.7h-6.3V19c0-0.7,0.2-1.2,0.5-1.8c0.4-0.5,0.8-0.9,1.4-1.2
		c0.6-0.2,1.2-0.3,1.9-0.2s1.2,0.4,1.6,0.9l23.2,24.2V16.3h6.3V48.6z"/>
</g>
</svg>

</a>

<img src="/images/E_C_Logo.png" alt="mylogo.jpg">

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1643067537"></script>
<script type="text/javascript" src="/js/auto-complete.js?1643067537"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1643067537"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/about-this-site/" title="About This Site" class="dd-item
        
        
        
        ">
      <a href="/about-this-site/">
          About This Site
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/getting-started-with-r/" title="Getting Started with R" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/">
          Getting Started with R
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/getting-started-with-r/installing-r-rstudio/" title="Installing R and R Studio" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/installing-r-rstudio/">
          Installing R and R Studio
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started-with-r/rstudio-notebooks/" title="Using R Notebooks" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/rstudio-notebooks/">
          Using R Notebooks
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started-with-r/project-managment/" title="Basic Project Management" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/project-managment/">
          Basic Project Management
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started-with-r/data-entry/" title="Data Entry" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/data-entry/">
          Data Entry
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started-with-r/importing-data/" title="Importing Data" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/importing-data/">
          Importing Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started-with-r/data-types-structure/" title="Data Types &#43; Structure" class="dd-item
        
        
        
        ">
      <a href="/getting-started-with-r/data-types-structure/">
          Data Types &#43; Structure
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/data-manipulation/" title="Data Manipulation" class="dd-item
        
        
        
        ">
      <a href="/data-manipulation/">
          Data Manipulation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/data-manipulation/making-new-variables/" title="Making New Variables" class="dd-item
        
        
        
        ">
      <a href="/data-manipulation/making-new-variables/">
          Making New Variables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/data-manipulation/subsetting-data/" title="Subsetting data" class="dd-item
        
        
        
        ">
      <a href="/data-manipulation/subsetting-data/">
          Subsetting data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/data-manipulation/summarising-data/" title="Summarising data" class="dd-item
        
        
        
        ">
      <a href="/data-manipulation/summarising-data/">
          Summarising data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/data-manipulation/combining-datasets/" title="Combining datasets" class="dd-item
        
        
        
        ">
      <a href="/data-manipulation/combining-datasets/">
          Combining datasets
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/data-manipulation/reshaping-data/" title="Reshaping data" class="dd-item
        
        
        
        ">
      <a href="/data-manipulation/reshaping-data/">
          Reshaping data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/coding-skills/" title="Coding Skills" class="dd-item
        
        
        
        ">
      <a href="/coding-skills/">
          Coding Skills
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/coding-skills/good-practice/" title="Good Practices for Code" class="dd-item
        
        
        
        ">
      <a href="/coding-skills/good-practice/">
          Good Practices for Code
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/coding-skills/writing-functions/" title="Writing Functions" class="dd-item
        
        
        
        ">
      <a href="/coding-skills/writing-functions/">
          Writing Functions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/coding-skills/loops/" title="Using Loops" class="dd-item
        
        
        
        ">
      <a href="/coding-skills/loops/">
          Using Loops
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/coding-skills/version-control/" title="Version Control" class="dd-item
        
        
        
        ">
      <a href="/coding-skills/version-control/">
          Version Control
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/coding-skills/asking-code-questions/" title="Asking code questions" class="dd-item
        
        
        
        ">
      <a href="/coding-skills/asking-code-questions/">
          Asking code questions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/graphics/" title="Graphics" class="dd-item
        
        
        
        ">
      <a href="/graphics/">
          Graphics
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/graphics/basic-plotting/" title="Basic Plotting in R" class="dd-item
        
        
        
        ">
      <a href="/graphics/basic-plotting/">
          Basic Plotting in R
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/graphics/basic-plotting/one-continuous/" title="One Continuous Variable" class="dd-item
        
        
        
        ">
      <a href="/graphics/basic-plotting/one-continuous/">
          One Continuous Variable
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/basic-plotting/two-continuous/" title="Two Continuous Variable" class="dd-item
        
        
        
        ">
      <a href="/graphics/basic-plotting/two-continuous/">
          Two Continuous Variable
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/basic-plotting/one-continuous-one-factor/" title="One Continuous and One Categorical Variable" class="dd-item
        
        
        
        ">
      <a href="/graphics/basic-plotting/one-continuous-one-factor/">
          One Continuous and One Categorical Variable
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/ggplot/" title="Plotting in R with ggplot2" class="dd-item
        
        
        
        ">
      <a href="/graphics/ggplot/">
          Plotting in R with ggplot2
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/graphics/ggplot/ggplot-basics/" title="The Basics of ggplot2" class="dd-item
        
        
        
        ">
      <a href="/graphics/ggplot/ggplot-basics/">
          The Basics of ggplot2
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/ggplot/ggplot-appearance/" title="Customising your ggplot" class="dd-item
        
        
        
        ">
      <a href="/graphics/ggplot/ggplot-appearance/">
          Customising your ggplot
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/ggplot/ggplot-labels/" title="Titles and Axes Labels" class="dd-item
        
        
        
        ">
      <a href="/graphics/ggplot/ggplot-labels/">
          Titles and Axes Labels
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/ggplot/ggplot-colour-shapes/" title="Colours and Shapes" class="dd-item
        
        
        
        ">
      <a href="/graphics/ggplot/ggplot-colour-shapes/">
          Colours and Shapes
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/ggplot/ggplot-barplot/" title="Barplot with Errorbars" class="dd-item
        
        
        
        ">
      <a href="/graphics/ggplot/ggplot-barplot/">
          Barplot with Errorbars
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/multivariate-vis/" title="Multivariate Data" class="dd-item
        
        
        
        ">
      <a href="/graphics/multivariate-vis/">
          Multivariate Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/graphics/multivariate-vis/mds/" title="Multidimensional Scaling" class="dd-item
        
        
        
        ">
      <a href="/graphics/multivariate-vis/mds/">
          Multidimensional Scaling
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/multivariate-vis/pca/" title="Principal Component Analysis" class="dd-item
        
        
        
        ">
      <a href="/graphics/multivariate-vis/pca/">
          Principal Component Analysis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/multivariate-vis/cluster-analysis/" title="Cluster Analysis" class="dd-item
        
        
        
        ">
      <a href="/graphics/multivariate-vis/cluster-analysis/">
          Cluster Analysis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/multivariate-vis/heatmaps/" title="Heatmaps" class="dd-item
        
        
        
        ">
      <a href="/graphics/multivariate-vis/heatmaps/">
          Heatmaps
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/spatial-vis/" title="Spatial Data" class="dd-item
        
        
        
        ">
      <a href="/graphics/spatial-vis/">
          Spatial Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/graphics/spatial-vis/basic-raster/" title="The Basics of Rasters" class="dd-item
        
        
        
        ">
      <a href="/graphics/spatial-vis/basic-raster/">
          The Basics of Rasters
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/spatial-vis/simple-maps/" title="Simple Maps with ggmap" class="dd-item
        
        
        
        ">
      <a href="/graphics/spatial-vis/simple-maps/">
          Simple Maps with ggmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/graphics/spatial-vis/interactive/" title="Interactive Maps in R" class="dd-item
        
        
        
        ">
      <a href="/graphics/spatial-vis/interactive/">
          Interactive Maps in R
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/statistics/" title="Statistics" class="dd-item
        parent
        
        
        ">
      <a href="/statistics/">
          Statistics
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/t-tests/" title="T-tests" class="dd-item
        
        
        
        ">
      <a href="/statistics/t-tests/">
          T-tests
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/t-tests/one-sample/" title="One Sample T-test" class="dd-item
        
        
        
        ">
      <a href="/statistics/t-tests/one-sample/">
          One Sample T-test
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/t-tests/two-sample/" title="Two Sample T-test" class="dd-item
        
        
        
        ">
      <a href="/statistics/t-tests/two-sample/">
          Two Sample T-test
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/t-tests/paired-t-test/" title="Paired T-test" class="dd-item
        
        
        
        ">
      <a href="/statistics/t-tests/paired-t-test/">
          Paired T-test
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/" title="Linear Models" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/">
          Linear Models
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/linear-regression/" title="Linear Regression" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/linear-regression/">
          Linear Regression
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/linear-regression/interpret-lm-coeffs/" title="Interpreting Linear Regressions" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/linear-regression/interpret-lm-coeffs/">
          Interpreting Linear Regressions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/anova/" title="ANOVA" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/anova/">
          ANOVA
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/anova/anova-single/" title="Single Factor ANOVA" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/anova/anova-single/">
          Single Factor ANOVA
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/anova/anova-factorial/" title="Factorial ANOVA" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/anova/anova-factorial/">
          Factorial ANOVA
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/anova/anova-nested/" title="Nested ANOVA" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/anova/anova-nested/">
          Nested ANOVA
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/linear-models/interactions/" title="Understanding Interactions" class="dd-item
        
        
        
        ">
      <a href="/statistics/linear-models/interactions/">
          Understanding Interactions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/glms/" title="Generalised Linear Models (GLMs)" class="dd-item
        
        
        
        ">
      <a href="/statistics/glms/">
          Generalised Linear Models (GLMs)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/glms/glm-1/" title="Introduction and Binary Data" class="dd-item
        
        
        
        ">
      <a href="/statistics/glms/glm-1/">
          Introduction and Binary Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/glms/glm-2/" title="Count Data" class="dd-item
        
        
        
        ">
      <a href="/statistics/glms/glm-2/">
          Count Data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/glms/interpret-glm-coeffs/" title="Interpreting GLMs" class="dd-item
        
        
        
        ">
      <a href="/statistics/glms/interpret-glm-coeffs/">
          Interpreting GLMs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/mixed-models/" title="Mixed Models" class="dd-item
        parent
        
        
        ">
      <a href="/statistics/mixed-models/">
          Mixed Models
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/mixed-models/mixed-model-1/" title="Introduction" class="dd-item
        parent
        active
        
        ">
      <a href="/statistics/mixed-models/mixed-model-1/">
          Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/mixed-models/mixed-model-2/" title="Crossed and Nested Factors" class="dd-item
        
        
        
        ">
      <a href="/statistics/mixed-models/mixed-model-2/">
          Crossed and Nested Factors
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/mixed-models/mixed-model-3/" title="Generalised Mixed Models" class="dd-item
        
        
        
        ">
      <a href="/statistics/mixed-models/mixed-model-3/">
          Generalised Mixed Models
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/gams/" title="Generalised Additive Models (GAMs)" class="dd-item
        
        
        
        ">
      <a href="/statistics/gams/">
          Generalised Additive Models (GAMs)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/catagorical/" title="Catagorial Data Analyses" class="dd-item
        
        
        
        ">
      <a href="/statistics/catagorical/">
          Catagorial Data Analyses
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/catagorical/goodness-of-fit/" title="Goodness of Fit" class="dd-item
        
        
        
        ">
      <a href="/statistics/catagorical/goodness-of-fit/">
          Goodness of Fit
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/catagorical/contingency-tabs/" title="Contingency Tables" class="dd-item
        
        
        
        ">
      <a href="/statistics/catagorical/contingency-tabs/">
          Contingency Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/catagorical/fishers-exact/" title="Fisher&#39;s Exact Test" class="dd-item
        
        
        
        ">
      <a href="/statistics/catagorical/fishers-exact/">
          Fisher&#39;s Exact Test
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/power-analysis/" title="Power Analyses" class="dd-item
        
        
        
        ">
      <a href="/statistics/power-analysis/">
          Power Analyses
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/mvabund/" title="Multivariate Analysis with mvabund" class="dd-item
        
        
        
        ">
      <a href="/statistics/mvabund/">
          Multivariate Analysis with mvabund
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/time-series/" title="Time Series Forecast" class="dd-item
        
        
        
        ">
      <a href="/statistics/time-series/">
          Time Series Forecast
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/meta-analysis/" title="Meta-Analyses" class="dd-item
        
        
        
        ">
      <a href="/statistics/meta-analysis/">
          Meta-Analyses
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/statistics/meta-analysis/meta-analysis-1/" title="Introduction" class="dd-item
        
        
        
        ">
      <a href="/statistics/meta-analysis/meta-analysis-1/">
          Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/meta-analysis/meta-analysis-2/" title="Fixed-effect and Random-effect Models" class="dd-item
        
        
        
        ">
      <a href="/statistics/meta-analysis/meta-analysis-2/">
          Fixed-effect and Random-effect Models
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/statistics/meta-analysis/meta-analysis-3/" title="Multilevel Models" class="dd-item
        
        
        
        ">
      <a href="/statistics/meta-analysis/meta-analysis-3/">
          Multilevel Models
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/matcornic/hugo-theme-learn/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download matcornic/hugo-theme-learn on GitHub">Download</a>

    
    <a class="github-button" href="https://github.com/matcornic/hugo-theme-learn" data-icon="octicon-star" data-show-count="true" aria-label="Star matcornic/hugo-theme-learn on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/matcornic/hugo-theme-learn/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork matcornic/hugo-theme-learn on GitHub">Fork</a>

    <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/matcornic/hugo-theme-learn/edit/master/exampleSite/content/statistics/mixed-models/mixed-model-1/_index.html" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/statistics/'>Statistics</a> > <a href='/statistics/mixed-models/'>Mixed Models</a> > Introduction
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Introduction
            </h1>
          

        



	
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p><strong>Linear mixed models with one random effect</strong></p>
<p>You will need to use mixed effect models if you have a random factor in your experimental design. A random factor</p>
<ul>
<li>is categorical<br />
</li>
<li>has a large number of levels<br />
</li>
<li>only a random subsample of levels is included in your design<br />
</li>
<li>you want to make inference in general, and not only for the levels you observed.</li>
</ul>
<p>This is a tough concept to get your head around, and is best explained with an example. The data we will analyse here are counts of invertebrates at 3-4 sites in each of 7 (randomly chosen) estuaries. Here the estuaries are the random effect, as there are a large number of possible estuaries, and we only sample from a random few of them, but we would like to make inference about estuaries in general.</p>
<p><img src="Mixed_models_1_image.jpg" /></p>
<p>We will introduce mixed models in three parts</p>
<ol style="list-style-type: decimal">
<li><p>Mixed models 1 (this page) is an introduction to mixed models for a <strong>continuous</strong> response with <strong>one random effect</strong>. You will learn how to check assumptions and do inference, including the parametric bootstrap.</p></li>
<li><p><a href="http://environmentalcomputing.net/mixed-models-2/">Mixed models 2</a> extends this to <strong>multiple random effects</strong> with a continuous response. We look into how to model nested and crossed random effects.</p></li>
<li><p><a href="http://environmentalcomputing.net/mixed-models-3/">Mixed models 3</a> teaches you how to model <strong>discrete data</strong>, including counts and binary data, with random effects.</p></li>
</ol>
<p>All three pages will use the same data for illustration.</p>
<p><br><br></p>
<p><strong>Properties of mixed models</strong>
<br>
<strong>Assumptions</strong>. Mixed models make some important assumptions (we’ll check these later for our examples)</p>
<ol style="list-style-type: decimal">
<li>The observed <span class="math inline">\(y\)</span> are independent, conditional on some predictors <span class="math inline">\(x\)</span><br />
</li>
<li>The response <span class="math inline">\(y\)</span> are normally distributed conditional on some predictors <span class="math inline">\(x\)</span><br />
</li>
<li>The response <span class="math inline">\(y\)</span> has constant variance, conditional on some predictors <span class="math inline">\(x\)</span><br />
</li>
<li>There is a straight line relationship between <span class="math inline">\(y\)</span> and the predictors <span class="math inline">\(x\)</span> and random effects <span class="math inline">\(z\)</span><br />
</li>
<li>Random effects <span class="math inline">\(z\)</span> are independent of <span class="math inline">\(y\)</span>.<br />
</li>
<li>Random effects <span class="math inline">\(z\)</span> are normally distributed
<br><br></li>
</ol>
<div id="running-the-analysis" class="section level3">
<h3>Running the analysis</h3>
<p><br>
We will use the package <a href="https://cran.r-project.org/web/packages/lme4/index.html">lme4</a> for all our mixed effect modelling. It will allow us to model both continuous and discrete data with one or more random effects. First, install and load this package:</p>
<pre class="r"><code>library(lme4)</code></pre>
<p>We will analyse a data set that aimed to test the effect of water pollution on the abundance of some subtidal marine invertebrates by comparing samples from modified and pristine estuaries. As the total counts are large, we will assume the data is continuous. Later on in <a href="http://environmentalcomputing.net/mixed-models-3/">Mixed models 3</a>, we’ll model counts as discrete using Generalised linear mixed models (GLMMs).</p>
<p>Download the sample data set, <a href="http://environmentalcomputing.net/wp-content/uploads/2016/05/Estuaries.csv">Estuaries.csv</a>, and load into R.</p>
<pre class="r"><code>Estuaries = read.csv(&quot;Estuaries.csv&quot;, header = T)</code></pre>
<p><strong>Fitting a model with a fixed and random effect</strong></p>
<p>In this data set, we have a fixed effect (Modification; modified vs pristine) and a random effect (Estuary). We can use the <code>lmer</code> function to fit a model for any dependent variables with a continuous distribution. To fit a model for total abundance, we would use:</p>
<pre class="r"><code>ft.estu = lmer(Total ~ Modification + (1|Estuary),data=Estuaries, REML=T)</code></pre>
<p>where Total is the dependent variable (left of the ~), Modification is the fixed effect, and Estuary is the random effect.</p>
<p>Note the syntax for one random effect is <code>(1|Estuary)</code> - this is fitting a different intercept (hence <code>1</code>) for each Estuary.</p>
<p>This model can be fit by maximum likelihood (<code>REML=F</code>) or restricted maximum likelihood (<code>&gt;REML=T</code>). For fitting models it’s best to use REML, as it is less biased (unbiased for balanced samples), particularly in small samples. However to use the <code>anova</code> function below we need to refit with maximum likelihood.
<br><br></p>
</div>
<div id="assumptions-to-check" class="section level3">
<h3>Assumptions to check</h3>
<p><br>
Before we look at the results of our analysis, it’s important to check that our data met the assumptions of the model we used. Let’s look at all the assumptions in order.</p>
<p><strong>Assumption 1</strong>: The observed <span class="math inline">\(y\)</span> are independent, conditional on some fixed effects <span class="math inline">\(x\)</span> and random effects <span class="math inline">\(z\)</span></p>
<p>We can’t check this assumption, but you can ensure it’s true by taking a random sample within each level of the random effect in your experimental design.</p>
<p><strong>Assumption 2</strong>: The response <span class="math inline">\(y\)</span> are normally distributed conditional on some predictors <span class="math inline">\(x\)</span> and random effects <span class="math inline">\(z\)</span></p>
<p>This assumption is only critical when we have a small sample size or very skewed data. We can check it with a normal quantile plot of residuals.</p>
<pre class="r"><code>qqnorm(residuals(ft.estu))</code></pre>
<p><img src="/statistics/mixed-models/mixed-model-1/_index_files/figure-html/unnamed-chunk-5-1.png" width="500px" /></p>
<p>We are looking for a straight line relationship. Here, the assumption of normality seems reasonable.</p>
<p><strong>Assumption 3</strong>: The response <span class="math inline">\(y\)</span> has constant variance, conditional on some fixed effects <span class="math inline">\(x\)</span> and random effects <span class="math inline">\(z\)</span></p>
<p>Like a linear model, a mixed model assumes constant variance. We can check this by looking for a fan shape in the residual plot (residuals vs fitted values).</p>
<pre class="r"><code>scatter.smooth(residuals(ft.estu)~fitted(ft.estu))</code></pre>
<p><img src="/statistics/mixed-models/mixed-model-1/_index_files/figure-html/unnamed-chunk-6-1.png" width="500px" /></p>
<p>This residual plot seems reasonable, there are differences in variability between estuaries, but variability does not increase with the mean. Note, that the function <code>scatter.smooth</code> is just a scatter plot with a fitted, smoothed curve.</p>
<p><strong>Assumption 4</strong>: There is a straight line relationship between <span class="math inline">\(y\)</span> and the predictors <span class="math inline">\(x\)</span> and random effects <span class="math inline">\(z\)</span></p>
<p>To check this assumption, we check the residual plot again for non-linearity, or a U-shape. In our case there is no evidence of non-linearity. If the residuals seem to go down then up, or up then down, we may need to add a polynomial function of the predictors using the <code>poly</code> function.</p>
<p><strong>Assumption 5</strong>: Random effects <span class="math inline">\(z\)</span> are independent of <span class="math inline">\(y\)</span>.</p>
<p>We can’t check this assumption, but you can ensure it’s true by taking a random sample of estuaries.</p>
<p><strong>Assumption 6</strong>: Random effects <span class="math inline">\(z\)</span> are normally distributed.</p>
<p>This assumption is not crucial (and difficult) to check.
<br><br></p>
</div>
<div id="interpreting-the-results" class="section level3">
<h3>Interpreting the results</h3>
<p><br></p>
<p><strong>Hypothesis test for the fixed effect</strong></p>
<p>The package <code>lme4</code> won’t give you p-values for fixed effects as part of the output in <code>summary</code>. This is because the p-values from Wald tests (using <code>summary</code>) and likelihood ratio tests (using <code>anova</code>) are only approximate in mixed models.</p>
<p>Nevertheless, we will use the <code>anova</code> function to test for an effect of modification on the total abundance of invertebrates, taking into account the random effect of estuary.</p>
<p>First, we fit the full model by maximum likelihood, and a second model that lacks the fixed effect of Modification</p>
<pre class="r"><code>ft.estu = lmer(Total ~ Modification + (1|Estuary), data=Estuaries, REML=F)
ft.estu.0 = lmer(Total ~ (1|Estuary), data=Estuaries, REML=F)</code></pre>
<p>Then, we compare these two models with a likelihood ratio test, using the <code>anova</code> function.</p>
<pre class="r"><code>anova(ft.estu.0,ft.estu)</code></pre>
<pre><code>## Data: Estuaries
## Models:
## ft.estu.0: Total ~ (1 | Estuary)
## ft.estu: Total ~ Modification + (1 | Estuary)
##           npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## ft.estu.0    3 415.02 420.99 -204.51   409.02                       
## ft.estu      4 411.92 419.87 -201.96   403.92 5.1055  1    0.02385 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We find that there is evidence of an effect of Modification (p = 0.02385).</p>
<p>We can also calculate confidence intervals for each model parameter using the <code>confint</code> function.</p>
<pre class="r"><code>confint(ft.estu)</code></pre>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<pre><code>##                           2.5 %    97.5 %
## .sig01                 2.718166 12.538348
## .sigma                 7.676352 11.522837
## (Intercept)           31.918235 49.981321
## ModificationPristine -26.360731 -2.538241</code></pre>
<p>This also provides evidence for an effect of Modification as this parameter (i.e., the difference between the modified and pristine estuaries) has 95% confidence intervals that do not overlap zero.</p>
<p><strong>Hypothesis test for random effects</strong></p>
<p>You can use the <code>anova</code> function to test for random effects, but the p-values are very approximate and we do not recommend this procedure. Instead we will use a parametric bootstrap. This is a simulation based method which involves a fair chunk of code, but there’s not much about the code you have to change for different models, it’s mostly just a matter of copy-paste.</p>
<p>Parametric bootstrap</p>
<pre class="r"><code>nBoot=1000
lrStat=rep(NA,nBoot)
ft.null = lm(Total~Modification,data=Estuaries)#null model
ft.alt = lmer(Total~Modification+(1|Estuary),data=Estuaries,REML=F)#alternate model
lrObs = 2*logLik(ft.alt) - 2*logLik(ft.null) #observed test stat
for(iBoot in 1:nBoot)
{
  Estuaries$TotalSim=unlist(simulate(ft.null)) #resampled data
  bNull = lm(TotalSim~Modification,data=Estuaries)#null model
  bAlt = lmer(TotalSim~Modification+(1|Estuary),data=Estuaries,REML=F)#alternate model
  lrStat[iBoot] = 2*logLik(bAlt) - 2*logLik(bNull)#resampled test stat
}
mean(lrStat&gt;lrObs) #P-value for test of Estuary effect</code></pre>
<pre><code>## [1] 0.001</code></pre>
<p>There is strong evidence for including estuary in your model (p = 0.001). You could use similar code to test for the effect of Modification with a parametric bootstrap.
<br><br></p>
<p>###FAQ for mixed models
<br>
<strong>1.</strong> Do I need balanced samples to fit a mixed model?</p>
<p>No, unbalanced designs are fine. Balanced designs will generally give you better power though, so they are good to aim for.</p>
<p><strong>2</strong>. Should I sample many levels of the random effect, or lots of observations within each level?</p>
<p>This depends on what you are interested in. In our example, we are interested in the effect of modification. In the study design, estuaries fall directly below modification, so we need a lot of estuaries within each level of Modification to make good inference about the effects of modification. This is true in general, you need lots of samples in the level below the level you are primarily interested in.</p>
<p><strong>3.</strong> Does my random factor have to be a random effect?</p>
<p>Not necessarily. If you have a random factor (i.e., you have a random sample of categories from a categorical variable) and you want to make inferences about that variable in general, not just at the categories you observed, then include it as a random effect. If you are happy making inference about just the levels you observed, then you can include it as a fixed effect. In our example we wanted to make inference about modification in general, i.e. in every modified and unmodified estuary, so we included estuary as a random effect. If we had treated Estuary as a fixed factor, we would have been restricted to making conclusions about only the estuaries we sample.</p>
<p><strong>4.</strong> What if the levels of my factor aren’t really random?</p>
<p>This might be a problem as assumption 4 may not hold. You should always sample the random effect randomly to avoid bias and incorrect conclusions.
<br><br></p>
</div>
<div id="communicating-the-results" class="section level3">
<h3>Communicating the results</h3>
<p><br>
<strong>Written.</strong> Results of linear mixed models are communicated in a similar way to results for linear models. In your results section you should mention that you are using mixed models with R package lme4, and list your random and fixed effects. You should also mention how you carried out inference, i.e. likelihood ratio tests (using the <code>anova</code> function) or parametric bootstrap. In the results section for one predictor, it suffices to write one line, e.g. “There is strong evidence (p&lt;0.001) of negative effect of modification on total abundance. For multiple predictors it’s best to display the results in a table.</p>
<p><strong>Visual.</strong> The best way to visually communicate results will depend on your question, for a simple mixed model with one random effect, a plot of the raw data with the model means superimposed is one possibility. There is a little bit of code that is required for such a plot, and it will be a little different for your data and model.</p>
<pre class="r"><code>ModEst=unique(Estuaries[c(&quot;Estuary&quot;, &quot;Modification&quot;)]) #find which Estuaries are modified

# Prepare a vector of colors with specific color by modification levels
myColors &lt;- ifelse(unique(ModEst$Modification)==&quot;Modified&quot; , rgb(0.1,0.1,0.7,0.5) , 
              ifelse(unique(ModEst$Modification)==&quot;Pristine&quot;, rgb(0.8,0.1,0.3,0.6),
              &quot;grey90&quot; ) )

boxplot(Total~ Estuary,data=Estuaries,col=myColors,xlab=&quot;Estuary&quot;,ylab=&quot;Total invertebrates&quot;)
legend(&quot;bottomleft&quot;, inset=.02,
   c(&quot; Modified &quot;,&quot; Pristine &quot;), fill=unique(myColors), horiz=TRUE, cex=0.8)

 #0 if Modified, 1 if Pristine
is.mod = ifelse(unique(ModEst$Modification)==&quot;Modified&quot; , 0 , 
              ifelse(unique(ModEst$Modification)==&quot;Pristine&quot;, 1, NA))

Est.means=coef(ft.estu)$Estuary[,1]+coef(ft.estu)$Estuary[,2]*is.mod #Model means</code></pre>
<pre><code>## Warning in coef(ft.estu)$Estuary[, 2] * is.mod: longer object length is not a
## multiple of shorter object length</code></pre>
<pre class="r"><code>stripchart(Est.means~ sort(unique(Estuary)),data=Estuaries,pch=18,col=&quot;red&quot;,vertical = TRUE,add=TRUE)</code></pre>
<p><img src="/statistics/mixed-models/mixed-model-1/_index_files/figure-html/unnamed-chunk-11-1.png" width="672" />
<br><br></p>
</div>
<div id="further-help" class="section level3">
<h3>Further help</h3>
<p><br>
You can type <code>?lmer</code> into R for help with these functions.</p>
<p><a href="http://lme4.r-forge.r-project.org/book/Ch2.pdf">Draft book chapter</a> from the authors of lme4.</p>
<p style="margin-left: .5in; text-indent: -.5in;">
Faraway, JJ. <em>Extending the linear model with R: generalized linear, mixed effects and nonparametric regression models</em>. CRC press, 2005.
</p>
<p style="margin-left: .5in; text-indent: -.5in;">
Zuur, A, EN Ieno and GM Smith. <em>Analysing ecological data</em>. Springer Science &amp; Business Media, 2007.
</p>
<p><br><br></p>
<p><strong>Author</strong>: Gordana Popovic
<br>
Last updated:</p>
<pre><code>## [1] &quot;Mon Jan 24 12:21:01 2022&quot;</code></pre>
</div>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/statistics/mixed-models/" title="Mixed Models"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/statistics/mixed-models/mixed-model-2/" title="Crossed and Nested Factors" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1643067537"></script>
    <script src="/js/perfect-scrollbar.min.js?1643067537"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1643067537"></script>
    <script src="/js/jquery.sticky.js?1643067537"></script>
    <script src="/js/featherlight.min.js?1643067537"></script>
    <script src="/js/highlight.pack.js?1643067537"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1643067537"></script>
    <script src="/js/learn.js?1643067537"></script>
    <script src="/js/hugo-learn.js?1643067537"></script>
    
        
            <script src="/mermaid/mermaid.js?1643067537"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105947713-1', 'auto');
  ga('send', 'pageview');

</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"> </script>


  </body>
</html>
